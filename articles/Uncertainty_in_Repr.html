<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Uncertainty in estimating colony representativeness • ColonyRepr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Uncertainty in estimating colony representativeness">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ColonyRepr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/Pipeline_vignette.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/Uncertainty_in_Repr.html">Uncertainty in estimates</a></li>
    <li><a class="dropdown-item" href="../articles/Grouped.html">Multi-colony analysis</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Uncertainty in estimating colony representativeness</h1>
                        <h4 data-toc-skip class="author">Lars Ursem</h4>
            
            <h4 data-toc-skip class="date">2026-01-09</h4>
      

      <div class="d-none name"><code>Uncertainty_in_Repr.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://larsursem.github.io/ColonyRepr/">ColonyRepr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<p>In determining colony representativeness, we assume that the fitted
MM-curve accurately describes the trajectory of increasing the number of
tracked individuals over time. Since we make an estimate of the expected
within-colony variation directly based on the parameter-values from the
fitted MM-curve, which we then use to determine captured colony
representativeness, the robustness of the MM-fit will directly influence
the uncertainty around our calculated estimate of colony
representativeness. Let’s describe an example. You have tracked 20
individuals from a certain colony and performed the analysis described
above. The MM-curve is now fitted to 20 data points. The next year, you
track another individual and add this to your dataset. Now, you’ll fit
the curve to 21 data points. Ideally, the parameters of the curve
wouldn’t change. However, this is not the case, as the new information
will influence the fit. Consequently, you’ll extract different parameter
values from your second fit compared to your first fit. If these values
are similar to the ones from your first fit, great! Your estimated
colony representativeness will increase as predicted with the addition
of this extra individual. However, if the parameter values of the second
fit differ a lot from those of your first fit, your estimate of captured
colony representativeness will vary accordingly. You can assume that
your second calculation is closer to the truth, but you don’t know how
close. <br> In the following analysis, we will investigate how a fitted
Michaelis-Menten curve changes as the sample size of tracked individuals
increases. For all fitted MM-curves, we can then determine how many
individuals (n_to_track) we’d need to track to achieve a certain level
of colony representativeness, in our case 50%. If all fitted curves are
very similar, n_to_track will not differ a lot among the different fits,
indicating a robust fitting process. However, as we’ll see, the fitting
is not always as robust. <br><br> We can fit a MM-curve to all possible
sample sizes (&gt;5) within our colony sample using
<code>KDE_Repr_per_individual_fun</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Repr_per_ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/KDE_repr_per_individual_fun.html">KDE_repr_per_individual_fun</a></span><span class="op">(</span>combined_areas_df <span class="op">=</span> <span class="va">Combine</span><span class="op">$</span><span class="va">Kernel_areas</span><span class="op">)</span></span>
<span><span class="va">Repr_per_ind</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 12</span></span></span>
<span><span class="co">#&gt;   species      colony  month n_inds   mean     sd up_bound low_bound KDE_contour</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> species_name colony…    12      5 2.42<span style="color: #949494;">e</span>5 <span style="text-decoration: underline;">31</span>240.  <span style="text-decoration: underline;">273</span>511.   <span style="text-decoration: underline;">211</span>031.          50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> species_name colony…    12      6 2.89<span style="color: #949494;">e</span>5 <span style="text-decoration: underline;">27</span>822.  <span style="text-decoration: underline;">316</span>779.   <span style="text-decoration: underline;">261</span>136.          50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> species_name colony…    12      7 3.28<span style="color: #949494;">e</span>5 <span style="text-decoration: underline;">36</span>853.  <span style="text-decoration: underline;">364</span>813.   <span style="text-decoration: underline;">291</span>107.          50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> species_name colony…    12      8 3.62<span style="color: #949494;">e</span>5 <span style="text-decoration: underline;">36</span>505.  <span style="text-decoration: underline;">398</span>780.   <span style="text-decoration: underline;">325</span>770.          50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> species_name colony…    12      9 4.23<span style="color: #949494;">e</span>5 <span style="text-decoration: underline;">29</span>215.  <span style="text-decoration: underline;">452</span>296.   <span style="text-decoration: underline;">393</span>866.          50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> species_name colony…    12     10 4.59<span style="color: #949494;">e</span>5 <span style="text-decoration: underline;">17</span>590.  <span style="text-decoration: underline;">476</span>548.   <span style="text-decoration: underline;">441</span>368.          50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> species_name colony…    12     11 5.01<span style="color: #949494;">e</span>5     0   <span style="text-decoration: underline;">500</span>707.   <span style="text-decoration: underline;">500</span>707.          50</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: A_mean &lt;dbl&gt;, B_mean &lt;dbl&gt;, Repr &lt;dbl&gt;</span></span></span></code></pre></div>
<p>As this example only contains a very small number of tracks, we can
only really use it to show how to run
<code>KDE_Repr_per_individual_fun</code> and what the function returns.
However, if we’d performed a similar approach on a data set with many
more tracked individuals and retrieval dates, we could use the output to
gain insight into uncertainty of the model MM-fit. We’ll show this
next.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">Sens_MM</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 46</span></span>
<span><span class="co">#&gt; Columns: 6</span></span>
<span><span class="co">#&gt; $ species     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "species_name2"<span style="color: #949494;">, </span>"species_name2"<span style="color: #949494;">, </span>"species_name2"<span style="color: #949494;">, </span>"specie…</span></span>
<span><span class="co">#&gt; $ colony      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "colony_name2"<span style="color: #949494;">, </span>"colony_name2"<span style="color: #949494;">, </span>"colony_name2"<span style="color: #949494;">, </span>"colony_na…</span></span>
<span><span class="co">#&gt; $ KDE_contour <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 75<span style="color: #949494;">, </span>75<span style="color: #949494;">, </span>75<span style="color: #949494;">, </span>75<span style="color: #949494;">, </span>75<span style="color: #949494;">, </span>75<span style="color: #949494;">, </span>75<span style="color: #949494;">, </span>75<span style="color: #949494;">, </span>75<span style="color: #949494;">, </span>75<span style="color: #949494;">, </span>75<span style="color: #949494;">, </span>75<span style="color: #949494;">, </span>75<span style="color: #949494;">, </span>75<span style="color: #949494;">, </span>75…</span></span>
<span><span class="co">#&gt; $ n_inds      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 5<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>7<span style="color: #949494;">, </span>8<span style="color: #949494;">, </span>9<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>11<span style="color: #949494;">, </span>12<span style="color: #949494;">, </span>13<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>15<span style="color: #949494;">, </span>16<span style="color: #949494;">, </span>17<span style="color: #949494;">, </span>18<span style="color: #949494;">, </span>19<span style="color: #949494;">, </span>20<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ A_mean      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span>20864046<span style="color: #949494;">, </span>4446375<span style="color: #949494;">, </span>3558973<span style="color: #949494;">, </span>5868536<span style="color: #949494;">, </span>1…</span></span>
<span><span class="co">#&gt; $ B_mean      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span>319.45906<span style="color: #949494;">, </span>63.24500<span style="color: #949494;">, </span>49.31880<span style="color: #949494;">, </span>86.0092…</span></span></code></pre></div>
<p>Let’s determine how much colony representativeness 100 tracked
individuals would yield, per fitted MM-curve (retrieval year
specific).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Sens_MM_100</span> <span class="op">&lt;-</span> <span class="va">Sens_MM</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Repr_100ind <span class="op">=</span> <span class="fl">100</span><span class="op">/</span><span class="va">A_mean</span> <span class="op">*</span> <span class="op">(</span><span class="va">A_mean</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="op">(</span><span class="va">B_mean</span><span class="op">+</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Sens_MM_100</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n_inds</span>, y <span class="op">=</span> <span class="va">Repr_100ind</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 5 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<p><img src="Uncertainty_in_Repr_files/figure-html/Repr_50-1.png" class="r-plt" alt="" width="672"></p>
<p>You can clearly see that the amount of within-colony variation
captured by 100 tracked individuals differs among the fitted curves.
Especially at low sample sizes, the variation is huge and problematic.
As sample size increases, expected representativeness captured by 100
individuals seems to stabalize, which indicates lower uncertainty of any
inference made from these curves fitted at higher sample sizes. <br>
Whether or not you’ve reached this stabilized stage depends on your
study system but is good to check using
<code>KDE_Repr_per_individual_fun</code>.</p>
<p><br> We can define some rules to determine the uncertainty of these
and other assessed colonies:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-lib/slider" class="external-link">slider</a></span><span class="op">)</span></span>
<span><span class="va">N_last_points_assessed</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">Sens_MM_100_unc</span> <span class="op">&lt;-</span> <span class="va">Sens_MM_100</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">colony</span>,<span class="va">KDE_contour</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Repr_100ind</span><span class="op">-</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">Repr_100ind</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">colony</span>, <span class="va">KDE_contour</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">n_inds</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">colony</span>, <span class="va">KDE_contour</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>moving_cumsum <span class="op">=</span> <span class="fu"><a href="https://slider.r-lib.org/reference/slide.html" class="external-link">slide_dbl</a></span><span class="op">(</span><span class="va">diff</span>, <span class="va">sum</span>,.complete <span class="op">=</span> <span class="cn">T</span>, .after <span class="op">=</span> <span class="va">N_last_points_assessed</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">colony</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">n_inds</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tot_cumsum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span>,</span>
<span>         uncertainty <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">n_inds</span> <span class="op">&lt;=</span> <span class="fl">15</span> <span class="op">~</span> <span class="st">"high"</span>,</span>
<span>                                 <span class="va">moving_cumsum</span> <span class="op">&lt;=</span> <span class="fl">5</span> <span class="op">~</span> <span class="st">"low"</span>,</span>
<span>                                 <span class="va">moving_cumsum</span> <span class="op">&gt;</span>  <span class="fl">5</span> <span class="op">&amp;</span> <span class="va">moving_cumsum</span> <span class="op">&lt;=</span><span class="fl">15</span> <span class="op">~</span> <span class="st">"medium"</span>,</span>
<span>                                 <span class="va">moving_cumsum</span> <span class="op">&gt;</span>  <span class="fl">15</span> <span class="op">~</span> <span class="st">"high"</span>,</span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">moving_cumsum</span><span class="op">)</span> <span class="op">~</span> <span class="st">"high"</span><span class="op">)</span>,</span>
<span>         uncertainty_is_medium <span class="op">=</span> <span class="va">uncertainty</span> <span class="op">==</span> <span class="st">"medium"</span>,</span>
<span>         uncertainty_is_high <span class="op">=</span> <span class="va">uncertainty</span> <span class="op">==</span> <span class="st">"high"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># group_by(species, colony) %&gt;% </span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># cumsum_medium = cumsum(uncertainty_is_medium),</span></span>
<span>    <span class="co"># cumsum_high = cumsum(uncertainty_is_high),</span></span>
<span>    <span class="co"># uncertainty = case_when(uncertainty == "low" &amp; cumsum_medium &gt;0 ~ "medium",</span></span>
<span>    <span class="co">#                         uncertainty == "medium" &amp; cumsum_high &gt;0 ~ "high",</span></span>
<span>    <span class="co">#                         T ~ uncertainty),</span></span>
<span>    uncertainty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">uncertainty</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"high"</span>,<span class="st">"medium"</span>,<span class="st">"low"</span><span class="op">)</span><span class="op">)</span></span>
<span>         <span class="op">)</span></span>
<span></span>
<span><span class="va">unc_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"high"</span> <span class="op">=</span> <span class="st">"#ff9966"</span>, <span class="st">"medium"</span> <span class="op">=</span> <span class="st">"#FFFF00"</span>, <span class="st">"low"</span> <span class="op">=</span> <span class="st">"#66cc00"</span><span class="op">)</span></span>
<span><span class="va">uncertainty_fill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">unc_cols</span>, name <span class="op">=</span> <span class="st">"Uncertainty category"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">Sens_MM_100_unc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n_inds</span>, y <span class="op">=</span> <span class="va">Repr_100ind</span>, fill <span class="op">=</span> <span class="va">uncertainty</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="va">uncertainty_fill</span></span>
<span><span class="co">#&gt; Warning: Removed 5 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<p><img src="Uncertainty_in_Repr_files/figure-html/uncertainty%20rules-1.png" class="r-plt" alt="" width="672"></p>
<p>You can see that the initially the Repr estimates are with high
uncertainty and that this stabalizes to medium uncertainty at a sample
size of 31 and than later to low uncertainty at 36. However, at a sample
size of 50 the cumulative difference with the previous ten points just
exceeds 5, giving this point a medium uncertainty level. Given this new
information, we can no longer say that some of the estimates based on
lower sample sizes have low uncertainty. We thus have to add another
condition, changing low uncertainty levels to medium if a higher sample
size obtains a medium uncertainty. We should do the same for medium
uncertainties when higher sample sizes obtain a high uncertainty.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Sens_MM_100_unc_complete</span> <span class="op">&lt;-</span> <span class="va">Sens_MM_100_unc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    cumsum_medium <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">uncertainty_is_medium</span><span class="op">)</span>,</span>
<span>    cumsum_high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">uncertainty_is_high</span><span class="op">)</span>,</span>
<span>    uncertainty <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">uncertainty</span> <span class="op">==</span> <span class="st">"low"</span> <span class="op">&amp;</span> <span class="va">cumsum_medium</span> <span class="op">&gt;</span><span class="fl">0</span> <span class="op">~</span> <span class="st">"medium"</span>,</span>
<span>                            <span class="va">uncertainty</span> <span class="op">==</span> <span class="st">"medium"</span> <span class="op">&amp;</span> <span class="va">cumsum_high</span> <span class="op">&gt;</span><span class="fl">0</span> <span class="op">~</span> <span class="st">"high"</span>,</span>
<span>                            <span class="cn">T</span> <span class="op">~</span> <span class="va">uncertainty</span><span class="op">)</span>,</span>
<span>    uncertainty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">uncertainty</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"high"</span>,<span class="st">"medium"</span>,<span class="st">"low"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">Sens_MM_100_unc_complete</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n_inds</span>, y <span class="op">=</span> <span class="va">Repr_100ind</span>, fill <span class="op">=</span> <span class="va">uncertainty</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="va">uncertainty_fill</span></span>
<span><span class="co">#&gt; Warning: Removed 5 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<p><img src="Uncertainty_in_Repr_files/figure-html/complete%20uncertainty-1.png" class="r-plt" alt="" width="672"></p>
<p><br><br></p>
<div class="section level3">
<h3 id="retrieval-year-vs-repr">Retrieval year vs Repr<a class="anchor" aria-label="anchor" href="#retrieval-year-vs-repr"></a>
</h3>
<p>We can also see how much extra information we collected per retrieval
year.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/KDE_repr_per_retrieval_year_fun.html">KDE_repr_per_retrieval_year_fun</a></span><span class="op">(</span><span class="va">contours_all</span>,</span>
<span>                                <span class="va">Combine</span><span class="op">$</span><span class="va">colony_projection</span><span class="op">)</span></span>
<span><span class="co">#&gt; Adding missing grouping variables: `h_par`, `month`</span></span>
<span><span class="co">#&gt; Adding missing grouping variables: `h_par`, `month`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 11</span></span></span>
<span><span class="co">#&gt;   h_par month species     colony retrieval_year n_inds KDE_contour   mean A_mean</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  34.8    12 species_na… colon…           <span style="text-decoration: underline;">1</span>883      9          50 4.52<span style="color: #949494;">e</span>5 5.82<span style="color: #949494;">e</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  34.8    12 species_na… colon…           <span style="text-decoration: underline;">1</span>884     11          50 5.01<span style="color: #949494;">e</span>5 4.65<span style="color: #949494;">e</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: B_mean &lt;dbl&gt;, Repr &lt;dbl&gt;</span></span></span></code></pre></div>
<p>When running this for a complete colony (e.g. the kittiwakes from
Sklinna) you can create plots like the following:</p>
<p><img src="Uncertainty_in_Repr_files/figure-html/retrieval_year_repr%202-1.png" class="r-plt" alt="" width="672"></p>
<p>Here we can see that uncertainty decreases as the sample size
increases (see change in point color). Also, we can see that over the
years we’ve increased our understanding of what happens at a colony
scale, as representativeness keeps on increasing. However, we can also
see that this increase in representativeness did not increase that much
anymore after 2021, even though we’ve collected tracking data of an
additional 15-20 individuals.</p>
<p>Topics to include:</p>
<ul>
<li>Sensitivity to h-parameter</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lars Ursem.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
